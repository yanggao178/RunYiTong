# 微信公众号直跳功能说明

## 功能概述

本次更新实现了点击医院后直接跳转到该医院微信公众号主页的功能，无需手动搜索。

## 实现原理

1. **直接跳转**：使用微信的 `weixin://profile/[公众号原始ID]` URL scheme 直接跳转到公众号主页
2. **降级处理**：如果直接跳转失败，自动回退到原有的搜索功能
3. **用户体验**：提供即时反馈，显示跳转状态

## 代码修改内容

### 1. 添加公众号原始ID映射

在 `HospitalAdapter.java` 中添加了 `hospitalWeChatIdMap`，用于存储医院名称与微信公众号原始ID的映射关系：

```java
private Map<String, String> hospitalWeChatIdMap = new HashMap<String, String>() {{
    put("北京协和医院", "gh_1234567890ab"); // 示例ID，需替换为真实ID
    put("北京大学第一医院", "gh_2345678901bc"); // 示例ID，需替换为真实ID
    put("中国人民解放军总医院", "gh_3456789012cd"); // 示例ID，需替换为真实ID
    put("首都医科大学附属北京天坛医院", "gh_4567890123de"); // 示例ID，需替换为真实ID
}};
```

### 2. 新增直跳方法

添加了 `openWeChatProfileDirectly()` 方法，实现直接跳转到公众号主页的功能。

### 3. 优化跳转逻辑

修改了 `openWeChatPublicAccount()` 方法，优先尝试直接跳转，失败时回退到搜索功能。

## 如何获取真实的微信公众号原始ID

**重要提示**：当前代码中使用的是示例ID（如 `gh_1234567890ab`），需要替换为真实的公众号原始ID才能正常工作。

### 获取方法：

1. **通过微信公众平台**：
   - 登录微信公众平台（mp.weixin.qq.com）
   - 在「设置与开发」->「基本配置」中查看「原始ID」

2. **通过微信客户端**：
   - 关注目标公众号
   - 进入公众号主页
   - 点击右上角「...」->「更多资料」
   - 查看「微信号」或「原始ID」

3. **通过第三方工具**：
   - 使用微信公众号查询工具
   - 输入公众号名称获取原始ID

### 原始ID格式：
- 通常以 `gh_` 开头
- 后跟12位字符（数字和小写字母组合）
- 例如：`gh_abcd1234efgh`

## 使用步骤

1. **替换示例ID**：
   - 打开 `HospitalAdapter.java` 文件
   - 找到 `hospitalWeChatIdMap` 映射表
   - 将示例ID替换为对应医院的真实公众号原始ID

2. **添加新医院**：
   ```java
   put("新医院名称", "gh_真实原始ID");
   ```

3. **测试功能**：
   - 重新编译并安装应用
   - 在挂号页面点击医院
   - 验证是否直接跳转到公众号主页

## 功能特点

- ✅ **即时跳转**：无需搜索，直接进入公众号主页
- ✅ **智能降级**：直跳失败时自动使用搜索功能
- ✅ **用户友好**：提供清晰的状态提示
- ✅ **兼容性好**：支持不同版本的微信客户端

## 注意事项

1. **原始ID准确性**：必须使用正确的公众号原始ID，否则无法跳转
2. **微信版本**：建议用户使用较新版本的微信客户端
3. **权限要求**：需要用户设备已安装微信应用
4. **网络连接**：需要良好的网络环境以确保跳转成功

## 故障排除

如果直跳功能不工作，请检查：

1. 原始ID是否正确
2. 微信是否已安装
3. 网络连接是否正常
4. 微信版本是否过旧

系统会自动回退到搜索功能，确保用户始终能够访问公众号。